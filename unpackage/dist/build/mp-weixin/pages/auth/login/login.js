"use strict";const e=require("../../../common/vendor.js"),s=require("../../../common/assets.js"),o={__name:"login",setup(o){const t=e.ref(!1),n=()=>{t.value=!0,e.wx$1.login({success:s=>{s.code?e.wx$1.request({url:"http://h65cf8b6.natappfree.cc/auth/wechat/login",method:"POST",data:{code:s.code},success:s=>{t.value=!1;const{openid:o,session_key:n}=s.data;console.log("用户 openid:",o),e.index.setStorageSync("userInfo",s.data),e.index.showToast({title:"登录成功",icon:"success",duration:2e3,success:()=>{setTimeout((()=>{e.index.switchTab({url:"/pages/tasks/list/list"})}),2e3)}})},fail:s=>{t.value=!1,console.error("请求失败",s),e.index.showToast({title:"登录失败，请重试",icon:"none"})}}):(t.value=!1,console.log("登录失败！"+s.errMsg),e.index.showToast({title:"登录失败，请重试",icon:"none"}))},fail:()=>{t.value=!1,e.index.showToast({title:"登录失败，请重试",icon:"none"})}})};return(o,t)=>({a:s._imports_0,b:e.o(n)})}};wx.createPage(o);
